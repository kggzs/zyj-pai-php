# 数据库更新日志

## 2024最新版更新内容

### 已合并的功能

1. **EXIF数据支持** (已合并到 init_latest.sql)
   - 添加了照片EXIF数据字段（经纬度、相机参数、拍摄参数等）
   - 添加了相应的索引以支持按地理位置和相机信息查询
   - 所有EXIF字段都设置为 `DEFAULT NULL`，确保向后兼容

### 数据库结构检查结果

✅ **所有字段都有默认值** - 不会因为空值导致运行错误
✅ **外键约束正确** - 所有外键都设置了适当的 ON DELETE 规则
✅ **索引完整** - 包括新添加的EXIF相关索引
✅ **字符集统一** - 所有表都使用 utf8mb4 字符集
✅ **向后兼容** - EXIF字段都是可选的（DEFAULT NULL）

### 注意事项

1. **result_path 字段**：虽然定义为 `NOT NULL`，但代码中插入时使用空字符串 `''`，这是允许的（VARCHAR类型可以接受空字符串）
2. **EXIF字段**：所有EXIF相关字段都是可选的，旧照片没有这些数据是正常的
3. **索引**：新增的索引可能会稍微增加插入时间，但会显著提升查询性能

### 使用说明

- **全新安装**：直接执行 `init_latest.sql` 即可
- **已有数据库**：如果数据库已存在，请使用 `migration_add_photo_exif.sql` 进行升级

